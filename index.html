<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob:; worker-src 'self' blob:;" />
    <title>Image Watermark Tool</title>
  </head>
  <body>
    <div id="app">
      <!-- Drag region for window (Mac/Windows toolbar area) -->
      <div class="titlebar-drag-region"></div>
      
      <!-- Header with app title and main actions -->
      <header class="app-header">
        <div class="header-title">
          <h1>Image Watermark Tool</h1>
          <p class="subtitle">Add watermarks to your images easily</p>
        </div>
        <div class="header-actions">
          <!-- Project actions -->
          <button id="btn-open-project" class="btn btn-secondary btn-icon-only" title="Open Project (Cmd/Ctrl+O)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
            </svg>
          </button>
          <button id="btn-save-project" class="btn btn-secondary btn-icon-only" title="Save Project (Cmd/Ctrl+S)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
              <polyline points="17 21 17 13 7 13 7 21"/>
              <polyline points="7 3 7 8 15 8"/>
            </svg>
          </button>
          <div class="header-divider"></div>
          <!-- Undo/Redo -->
          <button id="btn-undo" class="btn btn-secondary btn-icon-only" disabled title="Undo (Cmd/Ctrl+Z)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 10h10a5 5 0 0 1 5 5v2"/>
              <path d="M3 10l4-4"/>
              <path d="M3 10l4 4"/>
            </svg>
          </button>
          <button id="btn-redo" class="btn btn-secondary btn-icon-only" disabled title="Redo (Cmd/Ctrl+Shift+Z)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 10H11a5 5 0 0 0-5 5v2"/>
              <path d="M21 10l-4-4"/>
              <path d="M21 10l-4 4"/>
            </svg>
          </button>
          <div class="header-divider"></div>
          <!-- Main actions -->
          <button id="btn-add-images" class="btn btn-primary" title="Click to select images from your computer">
            + Add Images
          </button>
          <button id="btn-export-all" class="btn btn-success" disabled title="Export all images with watermark applied">
            Export All
          </button>
          <div class="header-divider"></div>
          <!-- Settings -->
          <button id="btn-settings" class="btn btn-secondary btn-icon-only" title="Settings (Cmd/Ctrl+,)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"/>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
            </svg>
          </button>
        </div>
      </header>

      <main class="app-main">
        <!-- Left sidebar: Image list -->
        <aside class="sidebar sidebar-left">
          <div class="sidebar-header">
            <h2>Your Images</h2>
            <span id="image-count" class="badge">0</span>
          </div>
          <div class="help-text sidebar-help">
            Drag and drop images here, or click "Add Images" button above.
          </div>
          <div id="image-list" class="image-list">
            <!-- Image thumbnails will be added here -->
            <div class="drop-zone" id="drop-zone">
              <div class="drop-zone-content">
                <span class="drop-icon">üìÅ</span>
                <p>Drop images here</p>
                <p class="small">or click Add Images</p>
              </div>
            </div>
          </div>
          <div class="sidebar-footer">
            <button id="btn-clear-all" class="btn btn-secondary btn-small" disabled title="Remove all images from the list">
              Clear All
            </button>
          </div>
        </aside>

        <!-- Center: Preview area -->
        <section class="preview-area">
          <div class="preview-header">
            <h2>Preview</h2>
            <div class="preview-header-controls">
              <div id="preview-info" class="preview-info">
                Select an image to preview
              </div>
              <div class="zoom-controls">
                <button id="btn-zoom-out" class="btn btn-secondary btn-icon-only btn-small" title="Zoom Out (Cmd/Ctrl+-)">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                    <line x1="8" y1="11" x2="14" y2="11"/>
                  </svg>
                </button>
                <span id="zoom-value" class="zoom-value">100%</span>
                <button id="btn-zoom-in" class="btn btn-secondary btn-icon-only btn-small" title="Zoom In (Cmd/Ctrl++)">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                    <line x1="11" y1="8" x2="11" y2="14"/>
                    <line x1="8" y1="11" x2="14" y2="11"/>
                  </svg>
                </button>
                <button id="btn-zoom-fit" class="btn btn-secondary btn-small" title="Fit to View (Cmd/Ctrl+0)">
                  Fit
                </button>
              </div>
            </div>
          </div>
          <div class="preview-container" id="preview-container">
            <canvas id="preview-canvas"></canvas>
            <div class="no-image-placeholder" id="no-image-placeholder">
              <span class="placeholder-icon">üñºÔ∏è</span>
              <p>No image selected</p>
              <p class="small">Add images and select one to preview</p>
            </div>
            <!-- Draggable watermark overlay -->
            <div id="watermark-overlay" class="watermark-overlay" style="display: none;">
              <div id="watermark-handle" class="watermark-handle" draggable="true">
                <span class="handle-icon">‚ÜîÔ∏è</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Right sidebar: Controls -->
        <aside class="sidebar sidebar-right">
          <!-- Watermark Settings -->
          <div class="control-section">
            <div class="control-section-header">
              <h3>Watermark Settings</h3>
              <button id="btn-apply-to-all" class="btn btn-secondary btn-small" disabled title="Apply current watermark settings to all images">
                Apply to All
              </button>
            </div>
            
            <div class="control-group">
              <label>Watermark Type</label>
              <div class="help-text">Choose between an image logo or custom text</div>
              <div class="radio-group">
                <label class="radio-label">
                  <input type="radio" name="watermark-type" value="image" checked />
                  <span>Image</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="watermark-type" value="text" />
                  <span>Text</span>
                </label>
              </div>
            </div>

            <!-- Image watermark controls -->
            <div id="image-watermark-controls">
              <div class="control-group">
                <label>Watermark Image</label>
                <div class="help-text">PNG with transparency recommended for best results</div>
                <button id="btn-select-watermark" class="btn btn-secondary">
                  Select Image...
                </button>
                <div id="watermark-preview" class="watermark-preview" style="display: none;">
                  <img id="watermark-preview-img" alt="Watermark preview" />
                  <button id="btn-remove-watermark" class="btn-icon" title="Remove watermark">√ó</button>
                </div>
              </div>
            </div>

            <!-- Text watermark controls -->
            <div id="text-watermark-controls" style="display: none;">
              <div class="control-group">
                <label for="watermark-text">Watermark Text</label>
                <input type="text" id="watermark-text" placeholder="Your watermark text" />
              </div>
              <div class="control-group">
                <label for="watermark-font">Font</label>
                <select id="watermark-font">
                  <option value="Arial">Arial</option>
                  <option value="Helvetica Neue">Helvetica</option>
                  <option value="Georgia">Georgia</option>
                  <option value="Times New Roman">Times New Roman</option>
                  <option value="Courier New">Courier New</option>
                  <option value="Verdana">Verdana</option>
                  <option value="Impact">Impact</option>
                </select>
              </div>
              <div class="control-row">
                <div class="control-group">
                  <label for="watermark-color">Color</label>
                  <input type="color" id="watermark-color" value="#ffffff" />
                </div>
                <div class="control-group">
                  <label class="checkbox-label">
                    <input type="checkbox" id="watermark-bold" />
                    <span>Bold</span>
                  </label>
                  <label class="checkbox-label">
                    <input type="checkbox" id="watermark-italic" />
                    <span>Italic</span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Common watermark settings -->
            <div class="control-group">
              <label>Position</label>
              <div class="help-text">Position is saved per image. Use "Apply to All" to sync.</div>
              <select id="watermark-position">
                <option value="bottom-right">Bottom Right (Recommended)</option>
                <option value="bottom-left">Bottom Left</option>
                <option value="top-right">Top Right</option>
                <option value="top-left">Top Left</option>
                <option value="center">Center</option>
                <option value="custom">Custom (Drag to position)</option>
              </select>
            </div>

            <div class="control-group">
              <label for="watermark-scale">Size: <span id="watermark-scale-value">20</span>%</label>
              <div class="help-text">Watermark size relative to image width</div>
              <input type="range" id="watermark-scale" min="5" max="50" value="20" />
            </div>

            <div class="control-group">
              <label for="watermark-opacity">Opacity: <span id="watermark-opacity-value">80</span>%</label>
              <div class="help-text">Higher opacity = more visible watermark</div>
              <input type="range" id="watermark-opacity" min="10" max="100" value="80" />
            </div>
          </div>

          <!-- Crop/Resize Settings -->
          <div class="control-section">
            <h3>Image Size & Crop</h3>
            
            <div class="control-group">
              <label>Preset</label>
              <div class="help-text">Choose a preset for common social media sizes</div>
              <select id="crop-preset">
                <option value="original">Original (No crop)</option>
                <option value="freeform">Freeform (Custom crop)</option>
                <optgroup label="Social Media">
                  <option value="facebook-thumb">Facebook Thumbnail (1200√ó630)</option>
                  <option value="facebook-post">Facebook Post (1200√ó1200)</option>
                  <option value="youtube-thumb">YouTube Thumbnail (1280√ó720)</option>
                  <option value="tiktok-thumb">TikTok Thumbnail (1080√ó1920)</option>
                </optgroup>
                <optgroup label="Common Ratios">
                  <option value="1:1">Square (1:1)</option>
                  <option value="4:5">Portrait (4:5) - Instagram</option>
                  <option value="16:9">Landscape (16:9) - Widescreen</option>
                  <option value="9:16">Vertical (9:16) - Stories/Reels</option>
                </optgroup>
              </select>
            </div>
          </div>

          <!-- Export Settings -->
          <div class="control-section">
            <h3>Export Settings</h3>
            
            <div class="control-group">
              <label>Format</label>
              <div class="help-text">
                <strong>PNG:</strong> Best quality, supports transparency, larger files<br />
                <strong>JPG:</strong> Good for photos, smaller files, no transparency<br />
                <strong>WebP:</strong> Best for web, small files, modern browsers
              </div>
              <select id="export-format">
                <option value="png">PNG (Lossless, best quality)</option>
                <option value="jpg">JPG (Smaller file size)</option>
                <option value="webp">WebP (Best for web)</option>
              </select>
            </div>

            <div class="control-group" id="quality-control">
              <label for="export-quality">Quality: <span id="export-quality-value">85</span>%</label>
              <div class="help-text">Higher = better quality but larger file size</div>
              <input type="range" id="export-quality" min="1" max="100" value="85" />
            </div>

            <div class="control-group">
              <label>Export Folder</label>
              <div class="help-text">Where to save your watermarked images</div>
              <button id="btn-select-folder" class="btn btn-secondary">
                Select Folder...
              </button>
              <div id="export-folder-path" class="folder-path">
                No folder selected
              </div>
            </div>
          </div>
        </aside>
      </main>

      <!-- Progress overlay -->
      <div id="progress-overlay" class="progress-overlay" style="display: none;">
        <div class="progress-modal">
          <h3>Exporting Images...</h3>
          <div class="progress-bar-container">
            <div id="progress-bar" class="progress-bar"></div>
          </div>
          <p id="progress-text">0 of 0 images processed</p>
          <button id="btn-cancel-export" class="btn btn-secondary">Cancel</button>
        </div>
      </div>
      
      <!-- Confirmation modal -->
      <div id="confirm-modal" class="modal-overlay" style="display: none;">
        <div class="modal">
          <div class="modal-icon warning">‚ö†Ô∏è</div>
          <h3>Confirm Action</h3>
          <p id="confirm-message">Are you sure?</p>
          <div class="modal-actions">
            <button id="btn-confirm-no" class="btn btn-secondary">Cancel</button>
            <button id="btn-confirm-yes" class="btn btn-primary">Yes, Apply to All</button>
          </div>
        </div>
      </div>
      
      <!-- Settings modal -->
      <div id="settings-modal" class="modal-overlay" style="display: none;">
        <div class="modal settings-modal">
          <div class="modal-header">
            <h3>Settings</h3>
            <button id="btn-close-settings" class="btn-icon btn-close" title="Close">√ó</button>
          </div>
          <div class="settings-content">
            <!-- Appearance -->
            <div class="settings-section">
              <h4>Appearance</h4>
              <div class="control-group">
                <label for="setting-theme">Theme</label>
                <select id="setting-theme">
                  <option value="auto">Auto (System)</option>
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                </select>
              </div>
            </div>
            
            <!-- Performance -->
            <div class="settings-section">
              <h4>Performance</h4>
              <div class="control-group">
                <label for="setting-preview-quality">Preview Quality</label>
                <div class="help-text">Higher quality uses more memory but looks better</div>
                <select id="setting-preview-quality">
                  <option value="performance">Performance (800px)</option>
                  <option value="balanced">Balanced (1200px) - Recommended</option>
                  <option value="quality">Quality (2400px)</option>
                  <option value="full">Full Resolution</option>
                </select>
              </div>
            </div>
            
            <!-- Default Export Settings -->
            <div class="settings-section">
              <h4>Default Export Settings</h4>
              <div class="control-group">
                <label for="setting-default-format">Default Format</label>
                <select id="setting-default-format">
                  <option value="png">PNG (Lossless)</option>
                  <option value="jpg">JPG (Smaller)</option>
                  <option value="webp">WebP (Modern)</option>
                </select>
              </div>
              <div class="control-group">
                <label for="setting-default-quality">Default Quality: <span id="setting-default-quality-value">85</span>%</label>
                <input type="range" id="setting-default-quality" min="1" max="100" value="85" />
              </div>
            </div>
          </div>
          <div class="modal-actions">
            <button id="btn-save-settings" class="btn btn-primary">Save Settings</button>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="/src/renderer.ts"></script>
  </body>
</html>
